# MySQL

参考资料：

《MySQL必知必会》

《Java开发手册》

## 基本概念

> 简述对存储过程的理解

+ MySQL 5开始添加了存储过程的支持；
+ 存在一些SQL需要针对多张表编写多条SQL语句；
+ 除此之外，需要执行的具体语句的顺序不合适固定的，需要根据查询条件确定；
+ 使用储存过程可以创建包含一条或多条MySQL语句的集合，用于复用；
+ 使用存储过程主要有3个好处，简单、安全、高性能。
+ 简单：存储过程将多条SQL封装起来，使用者只需要调用即可；
+ 安全：业务的修改仅需要改变存储过程内部逻辑即可，可以减少Bug出现的概率；
+ 高性能：使用储存过程比单独使用MySQL更快；
+ 总而言之，储存过程类似于一个函数，可以将复杂的SQL操作封装到一个存储过程中；
+ 存储过程的使用者无需指定请内部的实现逻辑便可以直接调用；

+ 在《Java开发手册》禁止使用存储过程，因为存储过程难以调试和扩展，没有移植性；



> 简述对触发器的理解

+ MySQL 5开始添加了对触发器的支持；
+ 与其他DMBS相比，MySQL 5支持的触发器功能有限；
+ 触发器可以在某些事件发生时自动执行；
+ 在MySQL中触发器可以响应DELETE/INSERT/UPDATE三种语句；
+ 创建触发器的时候需要使用安全访问权限，触发器是自动执行的；
+ 如果INSRT、UPDATE、DELETE能够执行，相关的触发器也能执行；
+ 使用触发器可以保证数据的一致性，如大小写、格式等；



> 简述SQL中左连接和右连接的区别

+ 左连接与右连接都是外连接的一种，两者主要区别是驱动表不一样；
+ 在外连接查询时，第一个要需要查询的表称为驱动表；
+ 左连接选择左边为驱动表；右连接选择右边为驱动表；
+ 对于外连接，需要先针对驱动表查询得到的结果，分别到被驱动表中查找匹配；
+ 当驱动表的记录在被驱动表招不到匹配的时候，仍然需要加入结果集中；
+ 如对于左连接而言，需要根据where条件确定出在左边表的记录；
+ 之后根据左边表的记录依次到右边表中根据on进行匹配；
+ 如果匹配则将左右两边的记录加入结果集，反之将左边记录加入结果集；



> 简述对数据库中锁的理解

+ 锁是保证并发事务下数据一致性的一种手段；
+ 锁的对象是事务，用于锁定数据库中的独享，如表、页、行；
+ 一般而言锁的对象在事务commit或rollback之后机型释放；
+ 锁本质上是内存中的一个结构，当一个事务想要对记录进行修改，首先会看内存中有没有这条记录的锁结构；
+ 在MySQL中锁按照事务操作的行为可以分为读写锁，按照事务操作的对象访问可以将锁分为多粒度锁；
+ 在MySQL中，不同存储引擎多锁的支持不一样；
+ 对于InnoDB支持的粒度最小的锁是行锁、MyISAM支持的粒度做小的锁是表锁；



> 简述对表锁、行锁以及页锁的理解

+ InnoDB支持不同粒度的锁；



简述对行锁的实现方法分类的理解
简述对数据库中锁升级的理解
简述对死锁以及解决死锁的理解
简述对数据库中悲观锁和乐观锁的理解
简述对事务的理解
简述数据库并发操作可能产生的异常(4种)
简述对事务隔离级别的理解
简述不可重复读和幻读的区别
简述对Record Lock、Gap Lock以及Next-Key Lock的理解
简述对数据库中封锁的理解.
简述数据库事务的传播行为
简述第一范式、第二范式与第三范式各自做了什么?

## 引擎

> 简述对数据库引擎的认识

+ 插件式的表存储引擎是MySQL区别于其他数据库的最重要特点；
+ MySQL的架构划分为两部分：Server层和存储引擎层；
+ Sever层提供了一系列数据库系统必须的，但与存储引擎无关的接口，而存储引擎层则主要负责底层物理结构的实现；
+ MySQL定义了存储引擎层的接口，不同的储存引擎可以在遵循这个接口的基础实现不同的细节；
+ 存储引擎的好处是，每个存储引擎都有各自的特点，可以根据具体应用建立不同存储引擎表；



> 简述MyISAM和InnoDB的区别和认识

【InnoDB】

+ InnoDB支持事务，主要面向OLTP应用；特点是支持行锁设计、支持外建；
+ InnoDB将数据存放在逻辑的表空间，用于自身进行管理；
+ InnoDB使用MVCC来实现高并发，实现了SQL四种标准的4种隔离级别，默认为「可重复读」；
+ InnoDB使用next-key lock策略避免幻读；
+ InnoDB提供插入缓冲、二次写和自适应哈希索引、预读等高性能、高可用的功能；
+ InnoDB使用聚簇索引来储存表中数据，每个表的储存按照主键的顺序进行存放；
+ InnoDB底层使用B+树结构储存实现索引；

【MyISAM】

+ MyISAM存储引擎不支持事务，使用表锁的设计，支持全文索引，主要面向OLAP应用；
+ MyISAM将表数据存储在两个文件：数据文件和索引文件；
+ MyISAM是非聚簇的，即数据文件和索引文件单独存储；
+ 除此之外MyISAM还支持表的压缩；
+ MyISAM底层使用B树实现索引。



> 简述MyISAM和InnoDB的应用场景

+ InnoDB支持事务，提供参照完整性的实现，主要面向OLTP应用；
+ MyISAM不支持事务，主要面向OLAP应用；




## 索引

> 简述什么是索引?

+ 数据库索引是一种数据结构，可以加快数据库记录的查找；
+ 适当的索引可以加快应用程序的整体性能；
+ 但太多的索引反而会降低应用程序的性能；



> 简述索引的分类
>
> 简述对B-Tree索引的理解
>
> 简述对哈希索引的理解
>
> 简述对全文索引的理解

+ InnoDB支持的索引类型有：B+树索引、全文索引和哈希索引(AHI)；
+ InnoDB支持的哈希索引是自适应的，即InnoDB会根据表的使用情况为表生成哈希索引；
+ InnoDB存储引擎会监控表的各个索引页的查询，当任务建立哈希索引可以带来速度提升，则建立哈希索引；
+ 自适应哈希所以可以看做是一种查询缓存；
+ InnoDB主要通过对索引列建立对应的B+树结构来实现数据的快速；
+ B+树结构中叶子节点保存了真实的数据内容，对于聚集索引保存的是整行数据，对于辅助保存的是对应记录的主键信息；
+ B+树结构中的非叶子节点保存了访问叶子节点的索引信息；
+ InnoDB默认根据主键id使用B+树建立聚簇索引来储存数据；
+ 由于B+树的构建特点，可以使得用户在使用索引查询数据的时候运用左前缀法则；
+ 但是对于左模糊匹配，将无法利用上索引，需要全表扫描；
+ 全文索引可以用于解决左右模糊匹配的查询问题；
+ 全文索引通过分析全文中的词信息，对其进行统计，分析，建立隐式；



> 简述索引的原理(为什么索引能加快查询)



主键与唯一性索引的区别

为什么加索引后查询快?
为什么加索引后写入修改删除变慢?
简述使用索引的优点
简述使用索引的缺点
简述对聚簇索引的理解
简述对非聚集索引的理解
简述聚簇索引和非聚簇索引间的区别.
简述对覆盖索引的理解
简述对联合索引的理解
简述索引的最左原则
简述索引失效的情况
简述为什么要使用联合索引?
简述索引优化的不冗余原则
简述索引优化的最大选择性原则.
简述索引的应用注意事项.
简述对MySQL中普通索引唯---索引和主索引的理解
简述MySQL中的常用数据类型
简述B树和B+树在用于文件系统时的区别

## 分库分表

简述对数据库分库分表的理解
简述对垂直切分的理解
简述对水平切分的理解
简述分库分表的依据
简述分库分表的工具(中间件)
简述分库分表算法

简述对数据库分库分表的理解
简述对垂直切分的理解
简述对水平切分的理解
简述分库分表的依据
简述分库分表的工具(中间件)
简述分库分表算法

## MySQL场景

简述一条SQL语句在MySQL中的执行过程
简述如何分析-条SQL语句执行地很慢的原因
简述对数据库读写分离的理解
简述读写分离存在的瓶颈以及相应的解决方案
MySQL删除- - -张表的方式与区别